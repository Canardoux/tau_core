{
  "version": 3,
  "sources": ["../../../../../../../../../../../third_party/devtools-frontend/src/front_end/ui/legacy/components/inline_editor/LinkSwatch.ts"],
  "sourcesContent": ["// Copyright (c) 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../../../core/i18n/i18n.js';\nimport * as LitHtml from '../../../lit-html/lit-html.js';\nimport * as VisualLogging from '../../../visual_logging/visual_logging.js';\nimport textButtonStyles from '../../textButton.css.legacy.js';\nimport * as ThemeSupport from '../../theme_support/theme_support.js';\n\nimport linkSwatchStyles from './linkSwatch.css.js';\n\nconst UIStrings = {\n  /**\n   *@description Text displayed in a tooltip shown when hovering over a var() CSS function in the Styles pane when the custom property in this function does not exist. The parameter is the name of the property.\n   *@example {--my-custom-property-name} PH1\n   */\n  sIsNotDefined: '{PH1} is not defined',\n};\nconst str_ = i18n.i18n.registerUIStrings('ui/legacy/components/inline_editor/LinkSwatch.ts', UIStrings);\nconst i18nString = i18n.i18n.getLocalizedString.bind(undefined, str_);\nconst {render, html, Directives: {ifDefined, classMap}} = LitHtml;\n\ninterface BaseLinkSwatchRenderData {\n  text: string;\n  title: string;\n  showTitle: boolean;\n  isDefined: boolean;\n  onLinkActivate: (linkText: string) => void;\n}\n\nclass BaseLinkSwatch extends HTMLElement {\n  protected readonly shadow = this.attachShadow({mode: 'open'});\n  protected onLinkActivate: (linkText: string, event: MouseEvent|KeyboardEvent) => void = () => undefined;\n  #linkElement: HTMLSpanElement|undefined;\n\n  connectedCallback(): void {\n    this.shadow.adoptedStyleSheets = [linkSwatchStyles];\n    ThemeSupport.ThemeSupport.instance().appendStyle(this.shadow, textButtonStyles);\n  }\n\n  set data(data: BaseLinkSwatchRenderData) {\n    this.onLinkActivate = (linkText: string, event: MouseEvent|KeyboardEvent) => {\n      if (event instanceof MouseEvent && event.button !== 0) {\n        return;\n      }\n\n      data.onLinkActivate(linkText);\n      event.consume(true);\n    };\n    data.showTitle = data.showTitle === undefined ? true : data.showTitle;\n    this.render(data);\n  }\n\n  get linkElement(): HTMLElement|undefined {\n    return this.#linkElement;\n  }\n\n  private render(data: BaseLinkSwatchRenderData): void {\n    const {isDefined, text, title} = data;\n    const classes = classMap({\n      'link-style': true,\n      'text-button': true,\n      'link-swatch-link': true,\n      undefined: !isDefined,\n    });\n    // The linkText's space must be removed, otherwise it cannot be triggered when clicked.\n    const onActivate = isDefined ? this.onLinkActivate.bind(this, text.trim()) : null;\n\n    // We added var popover, so don't need the title attribute when no need for showing title and\n    // only provide the data-title for the popover to get the data.\n    const {startNode} = render(\n        html`<button .disabled=${!isDefined} class=${classes}\n                     title=${ifDefined(data.showTitle ? title : undefined)}\n                     data-title=${ifDefined(!data.showTitle ? title : undefined)}\n                     @click=${onActivate} role=\"link\" tabindex=\"-1\">${text}</button>`,\n        this.shadow, {host: this});\n    if (startNode?.nextSibling instanceof HTMLButtonElement) {\n      this.#linkElement = startNode?.nextSibling;\n    }\n  }\n}\n\ninterface CSSVarSwatchRenderData {\n  variableName: string;\n  computedValue: string|null;\n  fromFallback: boolean;\n  fallbackText: string|null;\n  onLinkActivate: (linkText: string) => void;\n}\n\nexport class CSSVarSwatch extends HTMLElement {\n  protected readonly shadow = this.attachShadow({mode: 'open'});\n  #link: BaseLinkSwatch|undefined;\n\n  constructor() {\n    super();\n\n    this.tabIndex = -1;\n\n    this.addEventListener('focus', () => {\n      const link = this.shadow.querySelector<HTMLElement>('[role=\"link\"]');\n\n      if (link) {\n        link.focus();\n      }\n    });\n  }\n\n  set data(data: CSSVarSwatchRenderData) {\n    this.render(data);\n  }\n\n  get link(): BaseLinkSwatch|undefined {\n    return this.#link;\n  }\n\n  protected render(data: CSSVarSwatchRenderData): void {\n    const {variableName, fromFallback, computedValue, onLinkActivate} = data;\n\n    const isDefined = computedValue !== null && !fromFallback;\n    const title = isDefined ? computedValue ?? '' : i18nString(UIStrings.sIsNotDefined, {PH1: variableName});\n\n    this.#link = new BaseLinkSwatch();\n    this.#link.data = {\n      title,\n      showTitle: false,\n      text: variableName,\n      isDefined,\n      onLinkActivate,\n    };\n    this.#link.classList.add('css-var-link');\n    // clang-format off\n    render(\n        html`<span data-title=${data.computedValue || ''}\n          jslog=${VisualLogging.link('css-variable').track({click: true, hover: true})}\n        >var(${this.#link}<slot name=\"fallback\">${data.fallbackText ? `, ${data.fallbackText}` : ''}</slot>)</span>`,\n        this.shadow, {host: this});\n    // clang-format on\n  }\n}\n\nexport interface LinkSwatchRenderData {\n  isDefined: boolean;\n  text: string;\n  onLinkActivate: (linkText: string) => void;\n  jslogContext: string;\n}\n\nexport class LinkSwatch extends HTMLElement {\n  protected readonly shadow = this.attachShadow({mode: 'open'});\n\n  set data(data: LinkSwatchRenderData) {\n    this.render(data);\n  }\n\n  protected render(data: LinkSwatchRenderData): void {\n    const {text, isDefined, onLinkActivate, jslogContext} = data;\n    const title = isDefined ? text : i18nString(UIStrings.sIsNotDefined, {PH1: text});\n    render(\n        html`<span title=${data.text} jslog=${\n            VisualLogging.link().track({click: true}).context(jslogContext)}><devtools-base-link-swatch .data=${{\n          text,\n          isDefined,\n          title,\n          onLinkActivate,\n        } as BaseLinkSwatchRenderData}></devtools-base-link-swatch></span>`,\n        this.shadow, {host: this});\n  }\n}\n\ncustomElements.define('devtools-base-link-swatch', BaseLinkSwatch);\ncustomElements.define('devtools-link-swatch', LinkSwatch);\ncustomElements.define('devtools-css-var-swatch', CSSVarSwatch);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-base-link-swatch': BaseLinkSwatch;\n    'devtools-link-swatch': LinkSwatch;\n    'devtools-css-var-swatch': CSSVarSwatch;\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
