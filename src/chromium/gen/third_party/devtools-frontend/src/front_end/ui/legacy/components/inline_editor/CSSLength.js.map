{
  "version": 3,
  "sources": ["../../../../../../../../../../../third_party/devtools-frontend/src/front_end/ui/legacy/components/inline_editor/CSSLength.ts"],
  "sourcesContent": ["// Copyright (c) 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Host from '../../../../core/host/host.js';\nimport * as UI from '../../../legacy/legacy.js';\nimport * as LitHtml from '../../../lit-html/lit-html.js';\n\nimport cssLengthStyles from './cssLength.css.js';\nimport {ValueChangedEvent} from './InlineEditorUtils.js';\n\nconst {render, html} = LitHtml;\n\nexport class DraggingFinishedEvent extends Event {\n  static readonly eventName = 'draggingfinished';\n  constructor() {\n    super(DraggingFinishedEvent.eventName, {});\n  }\n}\n\nexport enum CSSLengthUnit {\n  // absolute units\n  PIXEL = 'px',\n  CENTIMETER = 'cm',\n  MILLIMETER = 'mm',\n  QUARTERMILLIMETER = 'Q',\n  INCH = 'in',\n  PICA = 'pc',\n  POINT = 'pt',\n\n  // relative units\n  CAP = 'cap',\n  CH = 'ch',\n  EM = 'em',\n  EX = 'ex',\n  IC = 'ic',\n  LH = 'lh',\n  RCAP = 'rcap',\n  RCH = 'rch',\n  REM = 'rem',\n  REX = 'rex',\n  RIC = 'ric',\n  RLH = 'rlh',\n  VB = 'vb',\n  VH = 'vh',\n  VI = 'vi',\n  VW = 'vw',\n  VMIN = 'vmin',\n  VMAX = 'vmax',\n}\n\nexport const CSS_LENGTH_REGEX =\n    new RegExp(`(?<value>[+-]?\\\\d*\\\\.?\\\\d+([Ee][+-]?\\\\d+)?)(?<unit>${Object.values(CSSLengthUnit).join('|')})`);\n\ntype CSSLengthData = {\n  lengthText: string,\n};\n\nexport class CSSLength extends HTMLElement {\n\n  private readonly shadow = this.attachShadow({mode: 'open'});\n  private readonly onDraggingValue = this.dragValue.bind(this);\n  private value = '';\n  private unit = CSSLengthUnit.PIXEL;\n  private isEditingSlot = false;\n  private isDraggingValue = false;\n  #valueMousedownTime = 0;\n\n  set data({lengthText}: CSSLengthData) {\n    const groups = lengthText.match(CSS_LENGTH_REGEX)?.groups;\n    if (!groups) {\n      throw new Error();\n    }\n    this.value = groups.value;\n    this.unit = groups.unit as CSSLengthUnit;\n    this.render();\n  }\n\n  connectedCallback(): void {\n    this.shadow.adoptedStyleSheets = [cssLengthStyles];\n  }\n\n  private dragValue(event: MouseEvent): void {\n    event.preventDefault();\n    event.stopPropagation();\n    if (Date.now() - this.#valueMousedownTime <= 300) {\n      // Delay drag callback by 300ms to prioritize click over drag.\n      return;\n    }\n\n    this.isDraggingValue = true;\n    const newValue = UI.UIUtils.createReplacementString(this.value, event);\n    if (newValue) {\n      this.value = newValue;\n      this.dispatchEvent(new ValueChangedEvent(`${this.value}${this.unit}`));\n      Host.userMetrics.swatchActivated(Host.UserMetrics.SwatchType.LENGTH);\n      this.render();\n    }\n  }\n\n  private onValueMousedown(event: MouseEvent): void {\n    if (event.button !== 0) {\n      return;\n    }\n\n    this.#valueMousedownTime = Date.now();\n\n    const targetDocument = event.target instanceof Node && event.target.ownerDocument;\n    if (targetDocument) {\n      targetDocument.addEventListener('mousemove', this.onDraggingValue, {capture: true});\n      targetDocument.addEventListener('mouseup', (event: MouseEvent) => {\n        targetDocument.removeEventListener('mousemove', this.onDraggingValue, {capture: true});\n\n        if (!this.isDraggingValue) {\n          return;\n        }\n\n        event.preventDefault();\n        event.stopPropagation();\n        this.isDraggingValue = false;\n        this.dispatchEvent(new DraggingFinishedEvent());\n      }, {once: true, capture: true});\n    }\n  }\n\n  private onValueMouseup(): void {\n    if (!this.isDraggingValue) {\n      this.isEditingSlot = true;\n      this.render();\n    }\n  }\n\n  private render(): void {\n    render(this.renderContent(), this.shadow, {\n      host: this,\n    });\n  }\n\n  private renderContent(): LitHtml.TemplateResult {\n    if (this.isEditingSlot) {\n      return html`<slot></slot>`;\n    }\n    // Disabled until https://crbug.com/1079231 is fixed.\n    // clang-format off\n      return html`<span class=\"value\" @mousedown=${this.onValueMousedown} @mouseup=${this.onValueMouseup}>${this.value}</span><span class=\"unit\">${this.unit}</span>`;\n    // clang-format on\n  }\n}\n\ncustomElements.define('devtools-css-length', CSSLength);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'devtools-css-length': CSSLength;\n  }\n}\n"],
  "mappings": "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",
  "names": ["CSSLengthUnit", "event"]
}
