{
  "version": 3,
  "sources": ["../../../../../../../../../third_party/devtools-frontend/src/front_end/ui/visual_logging/LoggingConfig.ts"],
  "sourcesContent": ["// Copyright 2023 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Root from '../../core/root/root.js';\n\nimport {knownContextValues} from './KnownContextValues.js';\n\nconst LOGGING_ATTRIBUTE = 'jslog';\n\ninterface TrackConfig {\n  click?: boolean;\n  dblclick?: boolean;\n  hover?: boolean;\n  drag?: boolean;\n  change?: boolean;\n  keydown?: boolean|string;\n  resize?: boolean;\n}\n\nexport interface LoggingConfig {\n  ve: number;\n  track?: TrackConfig;\n  context?: string;\n  parent?: string;\n}\n\nexport function needsLogging(element: Element): boolean {\n  return element.hasAttribute(LOGGING_ATTRIBUTE);\n}\n\nexport function getLoggingConfig(element: Element): LoggingConfig {\n  return parseJsLog(element.getAttribute(LOGGING_ATTRIBUTE) || '');\n}\n\nexport enum VisualElements {\n  /* eslint-disable @typescript-eslint/naming-convention -- Indexed access. */\n  TreeItem = 1,\n  Close = 2,\n  Counter = 3,\n  Drawer = 4,\n  Resizer = 5,\n  Toggle = 6,\n  Tree = 7,\n  TextField = 8,\n  AnimationClip = 9,\n  Section = 10,\n  SectionHeader = 11,\n  Timeline = 12,\n  CSSRuleHeader = 13,\n  Expand = 14,\n  ToggleSubpane = 15,\n  ControlPoint = 16,\n  Toolbar = 17,\n  Popover = 18,\n  BreakpointMarker = 19,\n  DropDown = 20,\n  Adorner = 21,\n  Gutter = 22,\n  MetricsBox = 23,\n  MetricsBoxPart = 24,\n  /* 25 used to be DOMBreakpointsPane, but free to grab now */\n  DOMBreakpoint = 26,\n  /* 27 used to be ElementPropertiesPane, but free to grab now */\n  /* 28 used to be EventListenersPane, but free to grab now */\n  Action = 29,\n  FilterDropdown = 30,\n  Dialog = 31,\n  BezierCurveEditor = 32,\n  /* 33 used to be BezierEditor, but free to grab now */\n  BezierPresetCategory = 34,\n  Preview = 35,\n  Canvas = 36,\n  ColorEyeDropper = 37,\n  /* 38 used to be ColorPicker, but free to grab now */\n  /* 39 used to be CopyColor, but free to grab now */\n  /* 40 used to be CssAngleEditor, but free to grab now */\n  /* 41 used to be CssFlexboxEditor, but free to grab now */\n  /* 42 used to be CssGridEditor, but free to grab now */\n  /* 43 used to be CssShadowEditor, but free to grab now */\n  Link = 44,\n  /* 45 used to be Next, but free to grab now */\n  Item = 46,\n  PaletteColorShades = 47,\n  Panel = 48,\n  /* 49 used to be Previous, but free to grab now */\n  ShowStyleEditor = 50,\n  Slider = 51,\n  CssColorMix = 52,\n  Value = 53,\n  Key = 54,\n  /* 55 used to be GridSettings, but free to grab now */\n  /* 56 used to be FlexboxOverlays, but free to grab now */\n  /* 57 used to be GridOverlays, but free to grab now */\n  /* 58 used to be JumpToElement, but free to grab now */\n  PieChart = 59,\n  PieChartSlice = 60,\n  PieChartTotal = 61,\n  ElementsBreadcrumbs = 62,\n  /* 63 used to be FullAccessibilityTree, but free to grab now */\n  /* 64 used to be ToggleDeviceMode, but free to grab now */\n  /* 65 used to be ToggleElementSearch, but free to grab now */\n  PanelTabHeader = 66,\n  Menu = 67,\n  TableRow = 68,\n  TableHeader = 69,\n  TableCell = 70,\n  /* 71 used to be StylesComputedPane, but free to grab now */\n  Pane = 72,\n  ResponsivePresets = 73,\n  DeviceModeRuler = 74,\n  MediaInspectorView = 75,\n  /* eslint-enable @typescript-eslint/naming-convention */\n}\n\nexport type VisualElementName = keyof typeof VisualElements;\n\nfunction resolveVe(ve: string): number {\n  return VisualElements[ve as VisualElementName] ?? 0;\n}\n\nconst reportedUnknownVeContext: Set<string> = new Set();\n\nfunction checkContextValue(context: string|number|undefined): void {\n  if (typeof context !== 'string' || !context.length || knownContextValues.has(context) ||\n      reportedUnknownVeContext.has(context)) {\n    return;\n  }\n  if (Root.Runtime.Runtime.queryParam('debugFrontend')) {\n    const stack = (new Error().stack || '').split('\\n').slice(3).join('\\n');\n    console.error(`Unknown VE context: ${context}${stack}`);\n  }\n  reportedUnknownVeContext.add(context);\n}\n\nexport function parseJsLog(jslog: string): LoggingConfig {\n  const components = jslog.replace(/ /g, '').split(';');\n  const getComponent = (name: string): string|undefined =>\n      components.find(c => c.startsWith(name))?.substr(name.length);\n  const ve = resolveVe(components[0]);\n  if (ve === 0) {\n    throw new Error('Unkown VE: ' + jslog);\n  }\n  const config: LoggingConfig = {ve};\n  const context = getComponent('context:');\n  if (context && context.trim().length) {\n    checkContextValue(context);\n    config.context = context;\n  }\n\n  const parent = getComponent('parent:');\n  if (parent) {\n    config.parent = parent;\n  }\n\n  const trackString = getComponent('track:');\n  if (trackString) {\n    config.track = {};\n    for (const track of trackString.split(',')) {\n      if (track.startsWith('keydown:')) {\n        config.track.keydown = track.substr('keydown:'.length);\n      } else {\n        config.track[track as keyof TrackConfig] = true;\n      }\n    }\n  }\n\n  return config;\n}\n\nexport interface ConfigStringBuilder {\n  /**\n   * Specifies an optional context for the visual element. For string contexts\n   * the convention is to use kebap case (e.g. `foo-bar`).\n   *\n   * @param value Optional context, which can be either a string or a number.\n   * @returns The builder itself.\n   */\n  context: (value: string|number|undefined) => ConfigStringBuilder;\n\n  /**\n   * Speficies the name of a `ParentProvider` used to lookup the parent visual element.\n   *\n   * @param value The name of a previously registered `ParentProvider`.\n   * @returns The builder itself.\n   */\n  parent: (value: string) => ConfigStringBuilder;\n\n  /**\n   * Specifies which DOM events to track for this visual element.\n   *\n   * @param options The set of DOM events to track.\n   * @returns The builder itself.\n   */\n  track: (options: TrackConfig) => ConfigStringBuilder;\n\n  /**\n   * Serializes the configuration into a `jslog` string.\n   *\n   * @returns The serialized string value to put on a DOM element via the `jslog` attribute.\n   */\n  toString: () => string;\n}\n\nexport function makeConfigStringBuilder(veName: VisualElementName, context?: string): ConfigStringBuilder {\n  const components: string[] = [veName];\n  if (typeof context === 'string' && context.trim().length) {\n    components.push(`context: ${context}`);\n    checkContextValue(context);\n  }\n  return {\n    context: function(value: string|number|undefined): ConfigStringBuilder {\n      if (typeof value === 'number' || typeof value === 'string' && value.length) {\n        components.push(`context: ${value}`);\n      }\n      checkContextValue(context);\n      return this;\n    },\n    parent: function(value: string): ConfigStringBuilder {\n      components.push(`parent: ${value}`);\n      return this;\n    },\n    track: function(options: TrackConfig): ConfigStringBuilder {\n      components.push(`track: ${\n          Object.entries(options).map(([key, value]) => value !== true ? `${key}: ${value}` : key).join(', ')}`);\n      return this;\n    },\n    toString: function(): string {\n      return components.join('; ');\n    },\n  };\n}\n"],
  "mappings": "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",
  "names": ["VisualElements"]
}
