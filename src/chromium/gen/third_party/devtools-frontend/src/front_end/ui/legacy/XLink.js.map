{
  "version": 3,
  "sources": ["../../../../../../../../../third_party/devtools-frontend/src/front_end/ui/legacy/XLink.ts"],
  "sourcesContent": ["// Copyright 2017 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Host from '../../core/host/host.js';\nimport * as Platform from '../../core/platform/platform.js';\nimport * as LitHtml from '../lit-html/lit-html.js';\nimport * as VisualLogging from '../visual_logging/visual_logging.js';\n\nimport * as ARIAUtils from './ARIAUtils.js';\nimport type {ContextMenu, Provider} from './ContextMenu.js';\nimport {html as xhtml} from './Fragment.js';\nimport {Tooltip} from './Tooltip.js';\nimport {\n  addReferrerToURLIfNecessary,\n  copyLinkAddressLabel,\n  MaxLengthForDisplayedURLs,\n  openLinkExternallyLabel,\n} from './UIUtils.js';\nimport {XElement} from './XElement.js';\n\nconst {html} = LitHtml;\n\nexport class XLink extends XElement {\n  hrefInternal: Platform.DevToolsPath.UrlString|null;\n  private clickable: boolean;\n  private readonly onClick: (arg0: Event) => void;\n  private readonly onKeyDown: (arg0: KeyboardEvent) => void;\n  static create(\n      url: string, linkText?: string, className?: string, preventClick?: boolean, jsLogContext?: string,\n      tabindex = '0'): HTMLElement {\n    if (!linkText) {\n      linkText = url;\n    }\n    className = className || '';\n    // clang-format off\n    // TODO(dgozman): migrate css from 'devtools-link' to 'x-link'.\n    const element = xhtml `\n  <x-link href='${url}' tabindex='${tabindex}' class='${className} devtools-link' ${preventClick ? 'no-click' : ''}\n  jslog=${VisualLogging.link().track({click: true, keydown:'Enter|Space'}).context(jsLogContext)}>${Platform.StringUtilities.trimMiddle(linkText, MaxLengthForDisplayedURLs)}</x-link>`;\n    // clang-format on\n    return element as HTMLElement;\n  }\n\n  constructor() {\n    super();\n\n    this.style.setProperty('display', 'inline');\n    ARIAUtils.markAsLink(this);\n    this.setAttribute('tabindex', '0');\n    this.setAttribute('target', '_blank');\n    this.setAttribute('rel', 'noopener');\n\n    this.hrefInternal = null;\n    this.clickable = true;\n\n    this.onClick = (event: Event) => {\n      event.consume(true);\n      if (this.hrefInternal) {\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance.openInNewTab(this.hrefInternal);\n      }\n      this.dispatchEvent(new Event('x-link-invoke'));\n    };\n    this.onKeyDown = (event: KeyboardEvent) => {\n      if (Platform.KeyboardUtilities.isEnterOrSpaceKey(event)) {\n        event.consume(true);\n        if (this.hrefInternal) {\n          Host.InspectorFrontendHost.InspectorFrontendHostInstance.openInNewTab(this.hrefInternal);\n        }\n      }\n      this.dispatchEvent(new Event('x-link-invoke'));\n    };\n  }\n\n  static override get observedAttributes(): string[] {\n    // TODO(dgozman): should be super.observedAttributes, but it does not compile.\n    return XElement.observedAttributes.concat(['href', 'no-click', 'title', 'tabindex']);\n  }\n\n  get href(): Platform.DevToolsPath.UrlString|null {\n    return this.hrefInternal;\n  }\n\n  override attributeChangedCallback(attr: string, oldValue: string|null, newValue: string|null): void {\n    if (attr === 'no-click') {\n      this.clickable = !newValue;\n      this.updateClick();\n      return;\n    }\n\n    if (attr === 'href') {\n      // For invalid or non-absolute URLs, `href` should remain `null`.\n      if (!newValue) {\n        newValue = '';\n      }\n      let href: Platform.DevToolsPath.UrlString|null = null;\n      let url: URL|null = null;\n      try {\n        url = new URL(addReferrerToURLIfNecessary(newValue as Platform.DevToolsPath.UrlString));\n        href = url.toString() as Platform.DevToolsPath.UrlString;\n      } catch {\n      }\n      if (url && url.protocol === 'javascript:') {\n        href = null;\n      }\n\n      this.hrefInternal = href;\n      if (!this.hasAttribute('title')) {\n        Tooltip.install(this, newValue);\n      }\n      this.updateClick();\n      return;\n    }\n\n    if (attr === 'tabindex') {\n      if (oldValue !== newValue) {\n        this.setAttribute('tabindex', newValue || '0');\n      }\n      return;\n    }\n\n    super.attributeChangedCallback(attr, oldValue, newValue);\n  }\n\n  private updateClick(): void {\n    if (this.hrefInternal !== null && this.clickable) {\n      this.addEventListener('click', this.onClick, false);\n      this.addEventListener('keydown', this.onKeyDown, false);\n      this.style.setProperty('cursor', 'pointer');\n    } else {\n      this.removeEventListener('click', this.onClick, false);\n      this.removeEventListener('keydown', this.onKeyDown, false);\n      this.style.removeProperty('cursor');\n    }\n  }\n}\n\nexport class ContextMenuProvider implements Provider<Node> {\n  appendApplicableItems(_event: Event, contextMenu: ContextMenu, target: Node): void {\n    let targetNode: Node|null = target;\n    while (targetNode && !(targetNode instanceof XLink)) {\n      targetNode = targetNode.parentNodeOrShadowHost();\n    }\n    if (!targetNode || !targetNode.href) {\n      return;\n    }\n    const node: XLink = targetNode;\n    contextMenu.revealSection().appendItem(openLinkExternallyLabel(), () => {\n      if (node.href) {\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance.openInNewTab(node.href);\n      }\n    }, {jslogContext: 'open-in-new-tab'});\n    contextMenu.revealSection().appendItem(copyLinkAddressLabel(), () => {\n      if (node.href) {\n        Host.InspectorFrontendHost.InspectorFrontendHostInstance.copyText(node.href);\n      }\n    }, {jslogContext: 'copy-link-address'});\n  }\n}\n\ncustomElements.define('x-link', XLink);\n\nexport const sample = html`<p>Hello, <x-link>world!</x-link></p>`;\n"],
  "mappings": "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",
  "names": []
}
