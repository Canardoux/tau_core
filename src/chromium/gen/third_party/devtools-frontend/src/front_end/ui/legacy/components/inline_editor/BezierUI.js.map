{
  "version": 3,
  "sources": ["../../../../../../../../../../../third_party/devtools-frontend/src/front_end/ui/legacy/components/inline_editor/BezierUI.ts"],
  "sourcesContent": ["// Copyright (c) 2015 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as VisualLogging from '../../../visual_logging/visual_logging.js';\nimport * as UI from '../../legacy.js';\n\ninterface Params {\n  width: number;\n  height: number;\n  marginTop: number;\n  controlPointRadius: number;\n  shouldDrawLine: boolean;\n}\n\nexport class BezierUI {\n  width: number;\n  height: number;\n  marginTop: number;\n  radius: number;\n  shouldDrawLine: boolean;\n\n  constructor({width, height, marginTop, controlPointRadius, shouldDrawLine}: Params) {\n    this.width = width;\n    this.height = height;\n    this.marginTop = marginTop;\n    this.radius = controlPointRadius;\n    this.shouldDrawLine = shouldDrawLine;\n  }\n\n  static drawVelocityChart(bezier: UI.Geometry.CubicBezier, path: Element, width: number): void {\n    const height = Height;\n    let pathBuilder: (string|number)[]|(string | number)[] = ['M', 0, height];\n    /** @const */ const sampleSize = 1 / 40;\n\n    let prev = bezier.evaluateAt(0);\n    for (let t = sampleSize; t < 1 + sampleSize; t += sampleSize) {\n      const current = bezier.evaluateAt(t);\n      let slope: number = (current.y - prev.y) / (current.x - prev.x);\n      const weightedX = prev.x * (1 - t) + current.x * t;\n      slope = Math.tanh(slope / 1.5);  // Normalise slope\n      pathBuilder = pathBuilder.concat(['L', (weightedX * width).toFixed(2), (height - slope * height).toFixed(2)]);\n      prev = current;\n    }\n    pathBuilder = pathBuilder.concat(['L', width.toFixed(2), height, 'Z']);\n    path.setAttribute('d', pathBuilder.join(' '));\n  }\n\n  curveWidth(): number {\n    return this.width - this.radius * 2;\n  }\n\n  curveHeight(): number {\n    return this.height - this.radius * 2 - this.marginTop * 2;\n  }\n\n  private drawLine(parentElement: Element, className: string, x1: number, y1: number, x2: number, y2: number): void {\n    const line = UI.UIUtils.createSVGChild(parentElement, 'line', className);\n    line.setAttribute('x1', String(x1 + this.radius));\n    line.setAttribute('y1', String(y1 + this.radius + this.marginTop));\n    line.setAttribute('x2', String(x2 + this.radius));\n    line.setAttribute('y2', String(y2 + this.radius + this.marginTop));\n  }\n\n  private drawControlPoints(parentElement: Element, startX: number, startY: number, controlX: number, controlY: number):\n      void {\n    this.drawLine(parentElement, 'bezier-control-line', startX, startY, controlX, controlY);\n    const circle = UI.UIUtils.createSVGChild(parentElement, 'circle', 'bezier-control-circle');\n    circle.setAttribute('jslog', `${VisualLogging.controlPoint('bezier.control-circle').track({drag: true})}`);\n    circle.setAttribute('cx', String(controlX + this.radius));\n    circle.setAttribute('cy', String(controlY + this.radius + this.marginTop));\n    circle.setAttribute('r', String(this.radius));\n  }\n\n  drawCurve(bezier: UI.Geometry.CubicBezier|null, svg: Element): void {\n    if (!bezier) {\n      return;\n    }\n    const width = this.curveWidth();\n    const height = this.curveHeight();\n    svg.setAttribute('width', String(this.width));\n    svg.setAttribute('height', String(this.height));\n    svg.removeChildren();\n    const group = UI.UIUtils.createSVGChild(svg, 'g');\n\n    if (this.shouldDrawLine) {\n      this.drawLine(group, 'linear-line', 0, height, width, 0);\n    }\n\n    const curve = UI.UIUtils.createSVGChild(group, 'path', 'bezier-path');\n    const curvePoints = [\n      new UI.Geometry.Point(\n          bezier.controlPoints[0].x * width + this.radius,\n          (1 - bezier.controlPoints[0].y) * height + this.radius + this.marginTop),\n      new UI.Geometry.Point(\n          bezier.controlPoints[1].x * width + this.radius,\n          (1 - bezier.controlPoints[1].y) * height + this.radius + this.marginTop),\n      new UI.Geometry.Point(width + this.radius, this.marginTop + this.radius),\n    ];\n    curve.setAttribute(\n        'd', 'M' + this.radius + ',' + (height + this.radius + this.marginTop) + ' C' + curvePoints.join(' '));\n\n    this.drawControlPoints(\n        group, 0, height, bezier.controlPoints[0].x * width, (1 - bezier.controlPoints[0].y) * height);\n    this.drawControlPoints(\n        group, width, 0, bezier.controlPoints[1].x * width, (1 - bezier.controlPoints[1].y) * height);\n  }\n}\n\nexport const Height = 26;\n"],
  "mappings": "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",
  "names": []
}
