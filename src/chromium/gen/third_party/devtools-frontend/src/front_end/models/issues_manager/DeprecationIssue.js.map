{
  "version": 3,
  "sources": ["../../../../../../../../../third_party/devtools-frontend/src/front_end/models/issues_manager/DeprecationIssue.ts"],
  "sourcesContent": ["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as i18n from '../../core/i18n/i18n.js';\nimport type * as SDK from '../../core/sdk/sdk.js';\nimport * as Protocol from '../../generated/protocol.js';\nimport * as Deprecation from '../../generated/Deprecation.js';\n\nimport {Issue, IssueCategory, IssueKind} from './Issue.js';\n\nimport {resolveLazyDescription, type MarkdownIssueDescription} from './MarkdownIssueDescription.js';\n\nconst UIStrings = {\n  /**\n   * @description This links to the chrome feature status page when one exists.\n   */\n  feature: 'Check the feature status page for more details.',\n  /**\n   * @description This links to the chromium dash schedule when a milestone is set.\n   * @example {100} milestone\n   */\n  milestone: 'This change will go into effect with milestone {milestone}.',\n  /**\n   * @description Title of issue raised when a deprecated feature is used\n   */\n  title: 'Deprecated feature used',\n};\n\nconst str_ = i18n.i18n.registerUIStrings('models/issues_manager/DeprecationIssue.ts', UIStrings);\nconst i18nLazyString = i18n.i18n.getLazilyComputedLocalizedString.bind(undefined, str_);\n\n// eslint-disable-next-line rulesdir/l10n_filename_matches\nconst strDeprecation = i18n.i18n.registerUIStrings('generated/Deprecation.ts', Deprecation.UIStrings);\nconst i18nLazyDeprecationString = i18n.i18n.getLazilyComputedLocalizedString.bind(undefined, strDeprecation);\n\nexport class DeprecationIssue extends Issue {\n  #issueDetails: Protocol.Audits.DeprecationIssueDetails;\n\n  constructor(issueDetails: Protocol.Audits.DeprecationIssueDetails, issuesModel: SDK.IssuesModel.IssuesModel) {\n    const issueCode = [\n      Protocol.Audits.InspectorIssueCode.DeprecationIssue,\n      issueDetails.type,\n    ].join('::');\n    super({code: issueCode, umaCode: 'DeprecationIssue'}, issuesModel);\n    this.#issueDetails = issueDetails;\n  }\n\n  getCategory(): IssueCategory {\n    return IssueCategory.OTHER;\n  }\n\n  details(): Protocol.Audits.DeprecationIssueDetails {\n    return this.#issueDetails;\n  }\n\n  getDescription(): MarkdownIssueDescription {\n    let messageFunction = (): string => '';\n    const maybeEnglishMessage = (Deprecation.UIStrings as Record<string, string>)[this.#issueDetails.type];\n    if (maybeEnglishMessage) {\n      messageFunction = i18nLazyDeprecationString(maybeEnglishMessage);\n    }\n\n    const links = [];\n    const deprecationMeta = Deprecation.DEPRECATIONS_METADATA[this.#issueDetails.type];\n    const feature = deprecationMeta?.chromeStatusFeature ?? 0;\n    if (feature !== 0) {\n      links.push({\n        link: `https://chromestatus.com/feature/${feature}`,\n        linkTitle: i18nLazyString(UIStrings.feature),\n      });\n    }\n    const milestone = deprecationMeta?.milestone ?? 0;\n    if (milestone !== 0) {\n      links.push({\n        link: 'https://chromiumdash.appspot.com/schedule',\n        linkTitle: i18nLazyString(UIStrings.milestone, {milestone}),\n      });\n    }\n    return resolveLazyDescription({\n      file: 'deprecation.md',\n      substitutions: new Map([\n        ['PLACEHOLDER_title', i18nLazyString(UIStrings.title)],\n        ['PLACEHOLDER_message', messageFunction],\n      ]),\n      links,\n    });\n  }\n\n  override sources(): Iterable<Protocol.Audits.SourceCodeLocation> {\n    if (this.#issueDetails.sourceCodeLocation) {\n      return [this.#issueDetails.sourceCodeLocation];\n    }\n    return [];\n  }\n\n  primaryKey(): string {\n    return JSON.stringify(this.#issueDetails);\n  }\n\n  getKind(): IssueKind {\n    return IssueKind.BREAKING_CHANGE;\n  }\n\n  static fromInspectorIssue(issuesModel: SDK.IssuesModel.IssuesModel, inspectorIssue: Protocol.Audits.InspectorIssue):\n      DeprecationIssue[] {\n    const details = inspectorIssue.details.deprecationIssueDetails;\n    if (!details) {\n      console.warn('Deprecation issue without details received.');\n      return [];\n    }\n    return [new DeprecationIssue(details, issuesModel)];\n  }\n}\n"],
  "mappings": ";AAIA,YAAY,UAAU;AAEtB,YAAY,cAAc;AAC1B,YAAY,iBAAiB;AAE7B,SAAQ,OAAO,eAAe,iBAAgB;AAE9C,SAAQ,8BAA4D;AAEpE,MAAM,YAAY;AAAA;AAAA;AAAA;AAAA,EAIhB,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA,EAKT,WAAW;AAAA;AAAA;AAAA;AAAA,EAIX,OAAO;AACT;AAEA,MAAM,OAAO,KAAK,KAAK,kBAAkB,6CAA6C,SAAS;AAC/F,MAAM,iBAAiB,KAAK,KAAK,iCAAiC,KAAK,QAAW,IAAI;AAGtF,MAAM,iBAAiB,KAAK,KAAK,kBAAkB,4BAA4B,YAAY,SAAS;AACpG,MAAM,4BAA4B,KAAK,KAAK,iCAAiC,KAAK,QAAW,cAAc;AAEpG,aAAM,yBAAyB,MAAM;AAAA,EAC1C;AAAA,EAEA,YAAY,cAAuD,aAA0C;AAC3G,UAAM,YAAY;AAAA,MAChB,SAAS,OAAO,mBAAmB;AAAA,MACnC,aAAa;AAAA,IACf,EAAE,KAAK,IAAI;AACX,UAAM,EAAC,MAAM,WAAW,SAAS,mBAAkB,GAAG,WAAW;AACjE,SAAK,gBAAgB;AAAA,EACvB;AAAA,EAEA,cAA6B;AAC3B,WAAO,cAAc;AAAA,EACvB;AAAA,EAEA,UAAmD;AACjD,WAAO,KAAK;AAAA,EACd;AAAA,EAEA,iBAA2C;AACzC,QAAI,kBAAkB,MAAc;AACpC,UAAM,sBAAuB,YAAY,UAAqC,KAAK,cAAc,IAAI;AACrG,QAAI,qBAAqB;AACvB,wBAAkB,0BAA0B,mBAAmB;AAAA,IACjE;AAEA,UAAM,QAAQ,CAAC;AACf,UAAM,kBAAkB,YAAY,sBAAsB,KAAK,cAAc,IAAI;AACjF,UAAM,UAAU,iBAAiB,uBAAuB;AACxD,QAAI,YAAY,GAAG;AACjB,YAAM,KAAK;AAAA,QACT,MAAM,oCAAoC,OAAO;AAAA,QACjD,WAAW,eAAe,UAAU,OAAO;AAAA,MAC7C,CAAC;AAAA,IACH;AACA,UAAM,YAAY,iBAAiB,aAAa;AAChD,QAAI,cAAc,GAAG;AACnB,YAAM,KAAK;AAAA,QACT,MAAM;AAAA,QACN,WAAW,eAAe,UAAU,WAAW,EAAC,UAAS,CAAC;AAAA,MAC5D,CAAC;AAAA,IACH;AACA,WAAO,uBAAuB;AAAA,MAC5B,MAAM;AAAA,MACN,eAAe,oBAAI,IAAI;AAAA,QACrB,CAAC,qBAAqB,eAAe,UAAU,KAAK,CAAC;AAAA,QACrD,CAAC,uBAAuB,eAAe;AAAA,MACzC,CAAC;AAAA,MACD;AAAA,IACF,CAAC;AAAA,EACH;AAAA,EAES,UAAwD;AAC/D,QAAI,KAAK,cAAc,oBAAoB;AACzC,aAAO,CAAC,KAAK,cAAc,kBAAkB;AAAA,IAC/C;AACA,WAAO,CAAC;AAAA,EACV;AAAA,EAEA,aAAqB;AACnB,WAAO,KAAK,UAAU,KAAK,aAAa;AAAA,EAC1C;AAAA,EAEA,UAAqB;AACnB,WAAO,UAAU;AAAA,EACnB;AAAA,EAEA,OAAO,mBAAmB,aAA0C,gBAC7C;AACrB,UAAM,UAAU,eAAe,QAAQ;AACvC,QAAI,CAAC,SAAS;AACZ,cAAQ,KAAK,6CAA6C;AAC1D,aAAO,CAAC;AAAA,IACV;AACA,WAAO,CAAC,IAAI,iBAAiB,SAAS,WAAW,CAAC;AAAA,EACpD;AACF;",
  "names": []
}
