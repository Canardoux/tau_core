{
  "version": 3,
  "sources": ["../../../../../../../../../third_party/devtools-frontend/src/front_end/models/issues_manager/RelatedIssue.ts"],
  "sourcesContent": ["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as SDK from '../../core/sdk/sdk.js';\n\nimport {CookieIssue, CookieIssueSubCategory} from './CookieIssue.js';\nimport type {Issue, IssueCategory} from './Issue.js';\nimport {IssuesManager} from './IssuesManager.js';\n\nexport type IssuesAssociatable = Readonly<SDK.NetworkRequest.NetworkRequest>|SDK.Cookie.Cookie|string;\n\nfunction issuesAssociatedWithNetworkRequest(issues: Issue[], request: SDK.NetworkRequest.NetworkRequest): Issue[] {\n  return issues.filter(issue => {\n    for (const affectedRequest of issue.requests()) {\n      if (affectedRequest.requestId === request.requestId()) {\n        return true;\n      }\n    }\n    return false;\n  });\n}\n\nfunction issuesAssociatedWithCookie(issues: Issue[], domain: string, name: string, path: string): Issue[] {\n  return issues.filter(issue => {\n    for (const cookie of issue.cookies()) {\n      if (cookie.domain === domain && cookie.name === name && cookie.path === path) {\n        return true;\n      }\n    }\n    return false;\n  });\n}\n\n/**\n * @throws In case obj has an unsupported type (i.e. not part of the IssuesAssociatble union).\n */\nexport function issuesAssociatedWith(issues: Issue[], obj: IssuesAssociatable): Issue[] {\n  if (obj instanceof SDK.NetworkRequest.NetworkRequest) {\n    return issuesAssociatedWithNetworkRequest(issues, obj);\n  }\n  if (obj instanceof SDK.Cookie.Cookie) {\n    return issuesAssociatedWithCookie(issues, obj.domain(), obj.name(), obj.path());\n  }\n  throw new Error(`issues can not be associated with ${JSON.stringify(obj)}`);\n}\n\nexport function hasIssues(obj: IssuesAssociatable): boolean {\n  const issues = Array.from(IssuesManager.instance().issues());\n  return issuesAssociatedWith(issues, obj).length > 0;\n}\n\nexport function hasIssueOfCategory(obj: IssuesAssociatable, category: IssueCategory): boolean {\n  const issues = Array.from(IssuesManager.instance().issues());\n  return issuesAssociatedWith(issues, obj).some(issue => issue.getCategory() === category);\n}\n\nexport function hasThirdPartyPhaseoutCookieIssue(obj: IssuesAssociatable): boolean {\n  const issues = Array.from(IssuesManager.instance().issues());\n  return issuesAssociatedWith(issues, obj)\n      .some(issue => CookieIssue.getSubCategory(issue.code()) === CookieIssueSubCategory.THIRD_PARTY_PHASEOUT_COOKIE);\n}\n\nexport function hasThirdPartyPhaseoutCookieIssueForDomain(domain: string): boolean {\n  const issues = Array.from(IssuesManager.instance().issues());\n  const issuesForDomain = issues.filter(issue => Array.from(issue.cookies()).some(cookie => cookie.domain === domain));\n  return issuesForDomain.some(\n      issue => CookieIssue.getSubCategory(issue.code()) === CookieIssueSubCategory.THIRD_PARTY_PHASEOUT_COOKIE);\n}\n\nexport async function reveal(obj: IssuesAssociatable, category?: IssueCategory): Promise<void|undefined> {\n  if (typeof obj === 'string') {\n    const issue = IssuesManager.instance().getIssueById(obj);\n    if (issue) {\n      return Common.Revealer.reveal(issue);\n    }\n  }\n  const issues = Array.from(IssuesManager.instance().issues());\n  const candidates = issuesAssociatedWith(issues, obj).filter(issue => !category || issue.getCategory() === category);\n  if (candidates.length > 0) {\n    return Common.Revealer.reveal(candidates[0]);\n  }\n}\n"],
  "mappings": ";AAIA,YAAY,YAAY;AACxB,YAAY,SAAS;AAErB,SAAQ,aAAa,8BAA6B;AAElD,SAAQ,qBAAoB;AAI5B,SAAS,mCAAmC,QAAiB,SAAqD;AAChH,SAAO,OAAO,OAAO,WAAS;AAC5B,eAAW,mBAAmB,MAAM,SAAS,GAAG;AAC9C,UAAI,gBAAgB,cAAc,QAAQ,UAAU,GAAG;AACrD,eAAO;AAAA,MACT;AAAA,IACF;AACA,WAAO;AAAA,EACT,CAAC;AACH;AAEA,SAAS,2BAA2B,QAAiB,QAAgB,MAAc,MAAuB;AACxG,SAAO,OAAO,OAAO,WAAS;AAC5B,eAAW,UAAU,MAAM,QAAQ,GAAG;AACpC,UAAI,OAAO,WAAW,UAAU,OAAO,SAAS,QAAQ,OAAO,SAAS,MAAM;AAC5E,eAAO;AAAA,MACT;AAAA,IACF;AACA,WAAO;AAAA,EACT,CAAC;AACH;AAKO,gBAAS,qBAAqB,QAAiB,KAAkC;AACtF,MAAI,eAAe,IAAI,eAAe,gBAAgB;AACpD,WAAO,mCAAmC,QAAQ,GAAG;AAAA,EACvD;AACA,MAAI,eAAe,IAAI,OAAO,QAAQ;AACpC,WAAO,2BAA2B,QAAQ,IAAI,OAAO,GAAG,IAAI,KAAK,GAAG,IAAI,KAAK,CAAC;AAAA,EAChF;AACA,QAAM,IAAI,MAAM,qCAAqC,KAAK,UAAU,GAAG,CAAC,EAAE;AAC5E;AAEO,gBAAS,UAAU,KAAkC;AAC1D,QAAM,SAAS,MAAM,KAAK,cAAc,SAAS,EAAE,OAAO,CAAC;AAC3D,SAAO,qBAAqB,QAAQ,GAAG,EAAE,SAAS;AACpD;AAEO,gBAAS,mBAAmB,KAAyB,UAAkC;AAC5F,QAAM,SAAS,MAAM,KAAK,cAAc,SAAS,EAAE,OAAO,CAAC;AAC3D,SAAO,qBAAqB,QAAQ,GAAG,EAAE,KAAK,WAAS,MAAM,YAAY,MAAM,QAAQ;AACzF;AAEO,gBAAS,iCAAiC,KAAkC;AACjF,QAAM,SAAS,MAAM,KAAK,cAAc,SAAS,EAAE,OAAO,CAAC;AAC3D,SAAO,qBAAqB,QAAQ,GAAG,EAClC,KAAK,WAAS,YAAY,eAAe,MAAM,KAAK,CAAC,MAAM,uBAAuB,2BAA2B;AACpH;AAEO,gBAAS,0CAA0C,QAAyB;AACjF,QAAM,SAAS,MAAM,KAAK,cAAc,SAAS,EAAE,OAAO,CAAC;AAC3D,QAAM,kBAAkB,OAAO,OAAO,WAAS,MAAM,KAAK,MAAM,QAAQ,CAAC,EAAE,KAAK,YAAU,OAAO,WAAW,MAAM,CAAC;AACnH,SAAO,gBAAgB;AAAA,IACnB,WAAS,YAAY,eAAe,MAAM,KAAK,CAAC,MAAM,uBAAuB;AAAA,EAA2B;AAC9G;AAEA,sBAAsB,OAAO,KAAyB,UAAmD;AACvG,MAAI,OAAO,QAAQ,UAAU;AAC3B,UAAM,QAAQ,cAAc,SAAS,EAAE,aAAa,GAAG;AACvD,QAAI,OAAO;AACT,aAAO,OAAO,SAAS,OAAO,KAAK;AAAA,IACrC;AAAA,EACF;AACA,QAAM,SAAS,MAAM,KAAK,cAAc,SAAS,EAAE,OAAO,CAAC;AAC3D,QAAM,aAAa,qBAAqB,QAAQ,GAAG,EAAE,OAAO,WAAS,CAAC,YAAY,MAAM,YAAY,MAAM,QAAQ;AAClH,MAAI,WAAW,SAAS,GAAG;AACzB,WAAO,OAAO,SAAS,OAAO,WAAW,CAAC,CAAC;AAAA,EAC7C;AACF;",
  "names": []
}
