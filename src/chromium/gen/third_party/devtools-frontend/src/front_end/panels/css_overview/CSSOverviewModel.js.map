{
  "version": 3,
  "sources": ["../../../../../../../../../third_party/devtools-frontend/src/front_end/panels/css_overview/CSSOverviewModel.ts"],
  "sourcesContent": ["// Copyright 2019 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as Root from '../../core/root/root.js';\nimport * as SDK from '../../core/sdk/sdk.js';\nimport type * as ProtocolProxyApi from '../../generated/protocol-proxy-api.js';\nimport * as Protocol from '../../generated/protocol.js';\nimport * as ColorPicker from '../../ui/legacy/components/color_picker/color_picker.js';\n\nimport type {ContrastIssue} from './CSSOverviewCompletedView.js';\nimport {CSSOverviewUnusedDeclarations, type UnusedDeclaration} from './CSSOverviewUnusedDeclarations.js';\n\ninterface NodeStyleStats {\n  elementCount: number;\n  backgroundColors: Map<string, Set<Protocol.DOM.BackendNodeId>>;\n  textColors: Map<string, Set<Protocol.DOM.BackendNodeId>>;\n  textColorContrastIssues: Map<string, ContrastIssue[]>;\n  fillColors: Map<string, Set<Protocol.DOM.BackendNodeId>>;\n  borderColors: Map<string, Set<Protocol.DOM.BackendNodeId>>;\n  fontInfo: Map<string, Map<string, Map<string, Protocol.DOM.BackendNodeId[]>>>;\n  unusedDeclarations: Map<string, UnusedDeclaration[]>;\n}\n\nexport interface GlobalStyleStats {\n  styleRules: number;\n  inlineStyles: number;\n  externalSheets: number;\n  stats: {\n    // Simple.\n    type: number,\n    class: number,\n    id: number,\n    universal: number,\n    attribute: number,\n\n    // Non-simple.\n    nonSimple: number,\n  };\n}\n\nexport class CSSOverviewModel extends SDK.SDKModel.SDKModel<void> {\n  readonly #runtimeAgent: ProtocolProxyApi.RuntimeApi;\n  readonly #cssAgent: ProtocolProxyApi.CSSApi;\n  readonly #domSnapshotAgent: ProtocolProxyApi.DOMSnapshotApi;\n  readonly #overlayAgent: ProtocolProxyApi.OverlayApi;\n\n  constructor(target: SDK.Target.Target) {\n    super(target);\n\n    this.#runtimeAgent = target.runtimeAgent();\n    this.#cssAgent = target.cssAgent();\n    this.#domSnapshotAgent = target.domsnapshotAgent();\n    this.#overlayAgent = target.overlayAgent();\n  }\n\n  highlightNode(node: Protocol.DOM.BackendNodeId): void {\n    const highlightConfig = {\n      contentColor: Common.Color.PageHighlight.Content.toProtocolRGBA(),\n      showInfo: true,\n      contrastAlgorithm: Root.Runtime.experiments.isEnabled('apca') ? Protocol.Overlay.ContrastAlgorithm.Apca :\n                                                                      Protocol.Overlay.ContrastAlgorithm.Aa,\n    };\n\n    void this.#overlayAgent.invoke_hideHighlight();\n    void this.#overlayAgent.invoke_highlightNode({backendNodeId: node, highlightConfig});\n  }\n\n  async getNodeStyleStats(): Promise<NodeStyleStats> {\n    const backgroundColors: Map<string, Set<Protocol.DOM.BackendNodeId>> = new Map();\n    const textColors: Map<string, Set<Protocol.DOM.BackendNodeId>> = new Map();\n    const textColorContrastIssues: Map<string, ContrastIssue[]> = new Map();\n    const fillColors: Map<string, Set<Protocol.DOM.BackendNodeId>> = new Map();\n    const borderColors: Map<string, Set<Protocol.DOM.BackendNodeId>> = new Map();\n    const fontInfo: Map<string, Map<string, Map<string, Protocol.DOM.BackendNodeId[]>>> = new Map();\n    const unusedDeclarations: Map<string, UnusedDeclaration[]> = new Map();\n    const snapshotConfig = {\n      computedStyles: [\n        'background-color',\n        'color',\n        'fill',\n        'border-top-width',\n        'border-top-color',\n        'border-bottom-width',\n        'border-bottom-color',\n        'border-left-width',\n        'border-left-color',\n        'border-right-width',\n        'border-right-color',\n        'font-family',\n        'font-size',\n        'font-weight',\n        'line-height',\n        'position',\n        'top',\n        'right',\n        'bottom',\n        'left',\n        'display',\n        'width',\n        'height',\n        'vertical-align',\n      ],\n      includeTextColorOpacities: true,\n      includeBlendedBackgroundColors: true,\n    };\n\n    const formatColor = (color: Common.Color.Color): string|null => {\n      if (color instanceof Common.Color.Legacy) {\n        return color.hasAlpha() ? color.asString(Common.Color.Format.HEXA) : color.asString(Common.Color.Format.HEX);\n      }\n\n      return color.asString();\n    };\n\n    const storeColor = (id: number, nodeId: number, target: Map<string, Set<number>>): Common.Color.Color|undefined => {\n      if (id === -1) {\n        return;\n      }\n\n      // Parse the color, discard transparent ones.\n      const colorText = strings[id];\n      if (!colorText) {\n        return;\n      }\n\n      const color = Common.Color.parse(colorText);\n      if (!color || color.asLegacyColor().rgba()[3] === 0) {\n        return;\n      }\n\n      // Format the color and use as the key.\n      const colorFormatted = formatColor(color);\n      if (!colorFormatted) {\n        return;\n      }\n\n      // Get the existing set of nodes with the color, or create a new set.\n      const colorValues = target.get(colorFormatted) || new Set();\n      colorValues.add(nodeId);\n\n      // Store.\n      target.set(colorFormatted, colorValues);\n\n      return color;\n    };\n\n    const isSVGNode = (nodeName: string): boolean => {\n      const validNodes = new Set([\n        'altglyph',\n        'circle',\n        'ellipse',\n        'path',\n        'polygon',\n        'polyline',\n        'rect',\n        'svg',\n        'text',\n        'textpath',\n        'tref',\n        'tspan',\n      ]);\n      return validNodes.has(nodeName.toLowerCase());\n    };\n\n    const isReplacedContent = (nodeName: string): boolean => {\n      const validNodes = new Set(['iframe', 'video', 'embed', 'img']);\n      return validNodes.has(nodeName.toLowerCase());\n    };\n\n    const isTableElementWithDefaultStyles = (nodeName: string, display: string): boolean => {\n      const validNodes = new Set(['tr', 'td', 'thead', 'tbody']);\n      return validNodes.has(nodeName.toLowerCase()) && display.startsWith('table');\n    };\n\n    let elementCount = 0;\n\n    const {documents, strings} = await this.#domSnapshotAgent.invoke_captureSnapshot(snapshotConfig);\n    for (const {nodes, layout} of documents) {\n      // Track the number of elements in the documents.\n      elementCount += layout.nodeIndex.length;\n\n      for (let idx = 0; idx < layout.styles.length; idx++) {\n        const styles = layout.styles[idx];\n        const nodeIdx = layout.nodeIndex[idx];\n        if (!nodes.backendNodeId || !nodes.nodeName) {\n          continue;\n        }\n        const nodeId = nodes.backendNodeId[nodeIdx];\n        const nodeName = nodes.nodeName[nodeIdx];\n\n        const [backgroundColorIdx, textColorIdx, fillIdx, borderTopWidthIdx, borderTopColorIdx, borderBottomWidthIdx, borderBottomColorIdx, borderLeftWidthIdx, borderLeftColorIdx, borderRightWidthIdx, borderRightColorIdx, fontFamilyIdx, fontSizeIdx, fontWeightIdx, lineHeightIdx, positionIdx, topIdx, rightIdx, bottomIdx, leftIdx, displayIdx, widthIdx, heightIdx, verticalAlignIdx] =\n            styles;\n\n        storeColor(backgroundColorIdx, nodeId, backgroundColors);\n        const textColor = storeColor(textColorIdx, nodeId, textColors);\n\n        if (isSVGNode(strings[nodeName])) {\n          storeColor(fillIdx, nodeId, fillColors);\n        }\n\n        if (strings[borderTopWidthIdx] !== '0px') {\n          storeColor(borderTopColorIdx, nodeId, borderColors);\n        }\n\n        if (strings[borderBottomWidthIdx] !== '0px') {\n          storeColor(borderBottomColorIdx, nodeId, borderColors);\n        }\n\n        if (strings[borderLeftWidthIdx] !== '0px') {\n          storeColor(borderLeftColorIdx, nodeId, borderColors);\n        }\n\n        if (strings[borderRightWidthIdx] !== '0px') {\n          storeColor(borderRightColorIdx, nodeId, borderColors);\n        }\n\n        /**\n         * Create a structure like this for font info:\n         *\n         *                 / size (Map) -- nodes (Array)\n         *                /\n         * Font family (Map) ----- weight (Map) -- nodes (Array)\n         *                \\\n         *                 \\ line-height (Map) -- nodes (Array)\n         */\n        if (fontFamilyIdx && fontFamilyIdx !== -1) {\n          const fontFamily = strings[fontFamilyIdx];\n          const fontFamilyInfo = fontInfo.get(fontFamily) || new Map();\n\n          const sizeLabel = 'font-size';\n          const weightLabel = 'font-weight';\n          const lineHeightLabel = 'line-height';\n\n          const size = fontFamilyInfo.get(sizeLabel) || new Map();\n          const weight = fontFamilyInfo.get(weightLabel) || new Map();\n          const lineHeight = fontFamilyInfo.get(lineHeightLabel) || new Map();\n\n          if (fontSizeIdx !== -1) {\n            const fontSizeValue = strings[fontSizeIdx];\n            const nodes = size.get(fontSizeValue) || [];\n            nodes.push(nodeId);\n            size.set(fontSizeValue, nodes);\n          }\n\n          if (fontWeightIdx !== -1) {\n            const fontWeightValue = strings[fontWeightIdx];\n            const nodes = weight.get(fontWeightValue) || [];\n            nodes.push(nodeId);\n            weight.set(fontWeightValue, nodes);\n          }\n\n          if (lineHeightIdx !== -1) {\n            const lineHeightValue = strings[lineHeightIdx];\n            const nodes = lineHeight.get(lineHeightValue) || [];\n            nodes.push(nodeId);\n            lineHeight.set(lineHeightValue, nodes);\n          }\n\n          // Set the data back.\n          fontFamilyInfo.set(sizeLabel, size);\n          fontFamilyInfo.set(weightLabel, weight);\n          fontFamilyInfo.set(lineHeightLabel, lineHeight);\n          fontInfo.set(fontFamily, fontFamilyInfo);\n        }\n\n        const blendedBackgroundColor =\n            textColor && layout.blendedBackgroundColors && layout.blendedBackgroundColors[idx] !== -1 ?\n            Common.Color.parse(strings[layout.blendedBackgroundColors[idx]]) :\n            null;\n        if (textColor && blendedBackgroundColor) {\n          const contrastInfo = new ColorPicker.ContrastInfo.ContrastInfo({\n            backgroundColors: [blendedBackgroundColor.asString(Common.Color.Format.HEXA) as string],\n            computedFontSize: fontSizeIdx !== -1 ? strings[fontSizeIdx] : '',\n            computedFontWeight: fontWeightIdx !== -1 ? strings[fontWeightIdx] : '',\n          });\n          const blendedTextColor =\n              textColor.asLegacyColor().blendWithAlpha(layout.textColorOpacities ? layout.textColorOpacities[idx] : 1);\n          contrastInfo.setColor(blendedTextColor);\n          const formattedTextColor = formatColor(blendedTextColor);\n          const formattedBackgroundColor = formatColor(blendedBackgroundColor.asLegacyColor());\n          const key = `${formattedTextColor}_${formattedBackgroundColor}`;\n          if (Root.Runtime.experiments.isEnabled('apca')) {\n            const contrastRatio = contrastInfo.contrastRatioAPCA();\n            const threshold = contrastInfo.contrastRatioAPCAThreshold();\n            const passes = contrastRatio && threshold ? Math.abs(contrastRatio) >= threshold : false;\n            if (!passes && contrastRatio) {\n              const issue = {\n                nodeId,\n                contrastRatio,\n                textColor: blendedTextColor,\n                backgroundColor: blendedBackgroundColor,\n                thresholdsViolated: {\n                  aa: false,\n                  aaa: false,\n                  apca: true,\n                },\n              };\n              if (textColorContrastIssues.has(key)) {\n                (textColorContrastIssues.get(key) as ContrastIssue[]).push(issue);\n              } else {\n                textColorContrastIssues.set(key, [issue]);\n              }\n            }\n          } else {\n            const aaThreshold = contrastInfo.contrastRatioThreshold('aa') || 0;\n            const aaaThreshold = contrastInfo.contrastRatioThreshold('aaa') || 0;\n            const contrastRatio = contrastInfo.contrastRatio() || 0;\n            if (aaThreshold > contrastRatio || aaaThreshold > contrastRatio) {\n              const issue = {\n                nodeId,\n                contrastRatio,\n                textColor: blendedTextColor,\n                backgroundColor: blendedBackgroundColor,\n                thresholdsViolated: {\n                  aa: aaThreshold > contrastRatio,\n                  aaa: aaaThreshold > contrastRatio,\n                  apca: false,\n                },\n              };\n              if (textColorContrastIssues.has(key)) {\n                (textColorContrastIssues.get(key) as ContrastIssue[]).push(issue);\n              } else {\n                textColorContrastIssues.set(key, [issue]);\n              }\n            }\n          }\n        }\n\n        CSSOverviewUnusedDeclarations.checkForUnusedPositionValues(\n            unusedDeclarations, nodeId, strings, positionIdx, topIdx, leftIdx, rightIdx, bottomIdx);\n\n        // Ignore SVG elements as, despite being inline by default, they can have width & height specified.\n        // Also ignore replaced content, for similar reasons.\n        if (!isSVGNode(strings[nodeName]) && !isReplacedContent(strings[nodeName])) {\n          CSSOverviewUnusedDeclarations.checkForUnusedWidthAndHeightValues(\n              unusedDeclarations, nodeId, strings, displayIdx, widthIdx, heightIdx);\n        }\n\n        if (verticalAlignIdx !== -1 && !isTableElementWithDefaultStyles(strings[nodeName], strings[displayIdx])) {\n          CSSOverviewUnusedDeclarations.checkForInvalidVerticalAlignment(\n              unusedDeclarations, nodeId, strings, displayIdx, verticalAlignIdx);\n        }\n      }\n    }\n\n    return {\n      backgroundColors,\n      textColors,\n      textColorContrastIssues,\n      fillColors,\n      borderColors,\n      fontInfo,\n      unusedDeclarations,\n      elementCount,\n    };\n  }\n\n  getComputedStyleForNode(nodeId: Protocol.DOM.NodeId): Promise<Protocol.CSS.GetComputedStyleForNodeResponse> {\n    return this.#cssAgent.invoke_getComputedStyleForNode({nodeId});\n  }\n\n  async getMediaQueries(): Promise<Map<string, Protocol.CSS.CSSMedia[]>> {\n    const queries = await this.#cssAgent.invoke_getMediaQueries();\n    const queryMap = new Map<string, Protocol.CSS.CSSMedia[]>();\n\n    if (!queries) {\n      return queryMap;\n    }\n\n    for (const query of queries.medias) {\n      // Ignore media queries applied to stylesheets; instead only use declared media rules.\n      if (query.source === 'linkedSheet') {\n        continue;\n      }\n\n      const entries = queryMap.get(query.text) || ([] as Protocol.CSS.CSSMedia[]);\n      entries.push(query);\n      queryMap.set(query.text, entries);\n    }\n\n    return queryMap;\n  }\n\n  async getGlobalStylesheetStats(): Promise<GlobalStyleStats|void> {\n    // There are no ways to pull CSSOM values directly today, due to its unserializable format,\n    // so instead we execute some JS within the page that extracts the relevant data and send that instead.\n    const expression = `(function() {\n      let styleRules = 0;\n      let inlineStyles = 0;\n      let externalSheets = 0;\n      const stats = {\n        // Simple.\n        type: new Set(),\n        class: new Set(),\n        id: new Set(),\n        universal: new Set(),\n        attribute: new Set(),\n\n        // Non-simple.\n        nonSimple: new Set()\n      };\n\n      for (const styleSheet of document.styleSheets) {\n        if (styleSheet.href) {\n          externalSheets++;\n        } else {\n          inlineStyles++;\n        }\n\n        // Attempting to grab rules can trigger a DOMException.\n        // Try it and if it fails skip to the next stylesheet.\n        let rules;\n        try {\n          rules = styleSheet.rules;\n        } catch (err) {\n          continue;\n        }\n\n        for (const rule of rules) {\n          if ('selectorText' in rule) {\n            styleRules++;\n\n            // Each group that was used.\n            for (const selectorGroup of rule.selectorText.split(',')) {\n              // Each selector in the group.\n              for (const selector of selectorGroup.split(\\/[\\\\t\\\\n\\\\f\\\\r ]+\\/g)) {\n                if (selector.startsWith('.')) {\n                  // Class.\n                  stats.class.add(selector);\n                } else if (selector.startsWith('#')) {\n                  // Id.\n                  stats.id.add(selector);\n                } else if (selector.startsWith('*')) {\n                  // Universal.\n                  stats.universal.add(selector);\n                } else if (selector.startsWith('[')) {\n                  // Attribute.\n                  stats.attribute.add(selector);\n                } else {\n                  // Type or non-simple selector.\n                  const specialChars = \\/[#\\.:\\\\[\\\\]|\\\\+>~]\\/;\n                  if (specialChars.test(selector)) {\n                    stats.nonSimple.add(selector);\n                  } else {\n                    stats.type.add(selector);\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n\n      return {\n        styleRules,\n        inlineStyles,\n        externalSheets,\n        stats: {\n          // Simple.\n          type: stats.type.size,\n          class: stats.class.size,\n          id: stats.id.size,\n          universal: stats.universal.size,\n          attribute: stats.attribute.size,\n\n          // Non-simple.\n          nonSimple: stats.nonSimple.size\n        }\n      }\n    })()`;\n    const {result} = await this.#runtimeAgent.invoke_evaluate({expression, returnByValue: true});\n\n    // TODO(paullewis): Handle errors properly.\n    if (result.type !== 'object') {\n      return;\n    }\n\n    return result.value;\n  }\n}\n\nSDK.SDKModel.SDKModel.register(CSSOverviewModel, {capabilities: SDK.Target.Capability.DOM, autostart: false});\n"],
  "mappings": "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",
  "names": ["nodes"]
}
