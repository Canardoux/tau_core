{
  "version": 3,
  "sources": ["../../../../../../../../../third_party/devtools-frontend/src/front_end/panels/emulation/InspectedPagePlaceholder.ts"],
  "sourcesContent": ["// Copyright 2014 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport * as Common from '../../core/common/common.js';\nimport * as UI from '../../ui/legacy/legacy.js';\n\nimport inspectedPagePlaceholderStyles from './inspectedPagePlaceholder.css.legacy.js';\n\nlet inspectedPagePlaceholderInstance: InspectedPagePlaceholder;\n\nexport class InspectedPagePlaceholder extends Common.ObjectWrapper.eventMixin<EventTypes, typeof UI.Widget.Widget>(\n    UI.Widget.Widget) {\n  private updateId?: number;\n  constructor() {\n    super(true);\n    this.registerRequiredCSS(inspectedPagePlaceholderStyles);\n    UI.ZoomManager.ZoomManager.instance().addEventListener(UI.ZoomManager.Events.ZOOM_CHANGED, this.onResize, this);\n    this.restoreMinimumSize();\n  }\n\n  static instance(opts: {\n    forceNew: null,\n  } = {forceNew: null}): InspectedPagePlaceholder {\n    const {forceNew} = opts;\n    if (!inspectedPagePlaceholderInstance || forceNew) {\n      inspectedPagePlaceholderInstance = new InspectedPagePlaceholder();\n    }\n\n    return inspectedPagePlaceholderInstance;\n  }\n\n  override onResize(): void {\n    if (this.updateId) {\n      this.element.window().cancelAnimationFrame(this.updateId);\n    }\n    this.updateId = this.element.window().requestAnimationFrame(this.update.bind(this, false));\n  }\n\n  restoreMinimumSize(): void {\n    this.setMinimumSize(150, 150);\n  }\n\n  clearMinimumSize(): void {\n    this.setMinimumSize(1, 1);\n  }\n\n  private dipPageRect(): {\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n  } {\n    const zoomFactor = UI.ZoomManager.ZoomManager.instance().zoomFactor();\n    const rect = this.element.getBoundingClientRect();\n    const bodyRect = this.element.ownerDocument.body.getBoundingClientRect();\n\n    const left = Math.max(rect.left * zoomFactor, bodyRect.left * zoomFactor);\n    const top = Math.max(rect.top * zoomFactor, bodyRect.top * zoomFactor);\n    const bottom = Math.min(rect.bottom * zoomFactor, bodyRect.bottom * zoomFactor);\n    const right = Math.min(rect.right * zoomFactor, bodyRect.right * zoomFactor);\n\n    return {x: left, y: top, width: right - left, height: bottom - top};\n  }\n\n  override update(force?: boolean): void {\n    delete this.updateId;\n    const rect = this.dipPageRect();\n    const bounds = {\n      x: Math.round(rect.x),\n      y: Math.round(rect.y),\n      height: Math.max(1, Math.round(rect.height)),\n      width: Math.max(1, Math.round(rect.width)),\n    };\n    if (force) {\n      // Short term fix for Lighthouse interop.\n      --bounds.height;\n      this.dispatchEventToListeners(Events.UPDATE, bounds);\n      ++bounds.height;\n    }\n    this.dispatchEventToListeners(Events.UPDATE, bounds);\n  }\n}\n\nexport const enum Events {\n  UPDATE = 'Update',\n}\n\nexport interface Bounds {\n  x: number;\n  y: number;\n  height: number;\n  width: number;\n}\n\nexport type EventTypes = {\n  [Events.UPDATE]: Bounds,\n};\n"],
  "mappings": ";AAIA,YAAY,YAAY;AACxB,YAAY,QAAQ;AAEpB,OAAO,oCAAoC;AAE3C,IAAI;AAEG,aAAM,iCAAiC,OAAO,cAAc;AAAA,EAC/D,GAAG,OAAO;AAAM,EAAE;AAAA,EACZ;AAAA,EACR,cAAc;AACZ,UAAM,IAAI;AACV,SAAK,oBAAoB,8BAA8B;AACvD,OAAG,YAAY,YAAY,SAAS,EAAE,iBAAiB,GAAG,YAAY,OAAO,cAAc,KAAK,UAAU,IAAI;AAC9G,SAAK,mBAAmB;AAAA,EAC1B;AAAA,EAEA,OAAO,SAAS,OAEZ,EAAC,UAAU,KAAI,GAA6B;AAC9C,UAAM,EAAC,SAAQ,IAAI;AACnB,QAAI,CAAC,oCAAoC,UAAU;AACjD,yCAAmC,IAAI,yBAAyB;AAAA,IAClE;AAEA,WAAO;AAAA,EACT;AAAA,EAES,WAAiB;AACxB,QAAI,KAAK,UAAU;AACjB,WAAK,QAAQ,OAAO,EAAE,qBAAqB,KAAK,QAAQ;AAAA,IAC1D;AACA,SAAK,WAAW,KAAK,QAAQ,OAAO,EAAE,sBAAsB,KAAK,OAAO,KAAK,MAAM,KAAK,CAAC;AAAA,EAC3F;AAAA,EAEA,qBAA2B;AACzB,SAAK,eAAe,KAAK,GAAG;AAAA,EAC9B;AAAA,EAEA,mBAAyB;AACvB,SAAK,eAAe,GAAG,CAAC;AAAA,EAC1B;AAAA,EAEQ,cAKN;AACA,UAAM,aAAa,GAAG,YAAY,YAAY,SAAS,EAAE,WAAW;AACpE,UAAM,OAAO,KAAK,QAAQ,sBAAsB;AAChD,UAAM,WAAW,KAAK,QAAQ,cAAc,KAAK,sBAAsB;AAEvE,UAAM,OAAO,KAAK,IAAI,KAAK,OAAO,YAAY,SAAS,OAAO,UAAU;AACxE,UAAM,MAAM,KAAK,IAAI,KAAK,MAAM,YAAY,SAAS,MAAM,UAAU;AACrE,UAAM,SAAS,KAAK,IAAI,KAAK,SAAS,YAAY,SAAS,SAAS,UAAU;AAC9E,UAAM,QAAQ,KAAK,IAAI,KAAK,QAAQ,YAAY,SAAS,QAAQ,UAAU;AAE3E,WAAO,EAAC,GAAG,MAAM,GAAG,KAAK,OAAO,QAAQ,MAAM,QAAQ,SAAS,IAAG;AAAA,EACpE;AAAA,EAES,OAAO,OAAuB;AACrC,WAAO,KAAK;AACZ,UAAM,OAAO,KAAK,YAAY;AAC9B,UAAM,SAAS;AAAA,MACb,GAAG,KAAK,MAAM,KAAK,CAAC;AAAA,MACpB,GAAG,KAAK,MAAM,KAAK,CAAC;AAAA,MACpB,QAAQ,KAAK,IAAI,GAAG,KAAK,MAAM,KAAK,MAAM,CAAC;AAAA,MAC3C,OAAO,KAAK,IAAI,GAAG,KAAK,MAAM,KAAK,KAAK,CAAC;AAAA,IAC3C;AACA,QAAI,OAAO;AAET,QAAE,OAAO;AACT,WAAK,yBAAyB,uBAAe,MAAM;AACnD,QAAE,OAAO;AAAA,IACX;AACA,SAAK,yBAAyB,uBAAe,MAAM;AAAA,EACrD;AACF;AAEO,WAAW,SAAX,kBAAWA,YAAX;AACL,EAAAA,QAAA,YAAS;AADO,SAAAA;AAAA,GAAA;",
  "names": ["Events"]
}
